<!DOCTYPE HTML>
<html>
	<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Trap Controller</title>


    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" integrity="sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==" crossorigin="anonymous">

    <script type="text/javascript" src="js/jq.js"></script>
	<script type="text/javascript" src="js/sb-1.4.1.js"></script>
    <script type="text/javascript">

		$(window).on("load", setup);

		var sb
			, app_name = "Playground of DOOM"
			;

		function setup (){
			var random_id = "0000" + Math.floor(Math.random() * 10000);

            /* Connection declarations */
			app_name = app_name + ' ' + random_id.substring(random_id.length-4);

			sb = new Spacebrew.Client({reconnect:true});

			sb.name(app_name);
			sb.description("This triggers traps and such in our playground.");

            /* Dynamically creates publishers */
			$('.button').each(function() {
                var target = $(this).attr('id');
                sb.addPublish( target, "boolean", "false" );
			});

			sb.addSubscribe( "toggleBackground", "boolean" );

			sb.onBooleanMessage = onBooleanMessage;

			sb.connect();

            /* Listeners */
			$(".button").on("mousedown", function(e){
    			var target = $(this).attr('id');
    			sb.send(target, "boolean", "true");
			});

			$(".button").on("mouseup", function(e){
                var target = $(this).attr('id');
    			sb.send("buttonPressA", "boolean", "false");
			});
		}

        /* Reciever Call */
		function onBooleanMessage( name, value ){
			console.log("[onBooleanMessage] boolean message received ", value);

			if (name == "routeA"){

			}

			if (value) {
		        document.body.style.background = "rgb(100,255,100)";
			} else {
		        document.body.style.background = "rgb(220,220,220)";
			}
		}

	</script>

	<style>
        .btn {
            display: block;
            text-align: center;
            width: 100%;
            margin-bottom: 15px;
        }
    </style>

	</head>

	<body>
    	<h3>Section 1</h3>
		<a class="button btn btn-default" id="sectionA1">1</a>
		<a class="button btn btn-default" id="sectionA2">2</a>
		<a class="button btn btn-default" id="sectionA3">3</a>
		<a class="button btn btn-default" id="sectionA4">4</a>

        <h3>Section 2</h3>
		<a class="button btn btn-default" id="sectionB1">1</a>
		<a class="button btn btn-default" id="sectionB2">2</a>
		<a class="button btn btn-default" id="sectionB3">3</a>
		<a class="button btn btn-default" id="sectionB4">4</a>

        <h3>Section 3</h3>
		<a class="button btn btn-default" id="sectionC1">1</a>
		<a class="button btn btn-default" id="sectionC2">2</a>
		<a class="button btn btn-default" id="sectionC3">3</a>
		<a class="button btn btn-default" id="sectionC4">4</a>

        <h3>Section 4</h3>
		<a class="button btn btn-default" id="sectionD1">1</a>
		<a class="button btn btn-default" id="sectionD2">2</a>
		<a class="button btn btn-default" id="sectionD3">3</a>
		<a class="button btn btn-default" id="sectionD4">4</a>
	</body>

</html>