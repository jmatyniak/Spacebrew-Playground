<!DOCTYPE HTML>
<html>
	<head>
    <title>Spacebrew Button (Boolean Example)</title>

    <meta charset="utf-8">
    <link rel="stylesheet" href="css/reset.css" type="text/css" media="screen" charset="utf-8" />
    <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

    <script type="text/javascript" src="js/jq.js"></script>
	<script type="text/javascript" src="js/sb-1.4.1.js"></script>
    <script type="text/javascript">

		$(window).on("load", setup);

		var sb
			, app_name = "Playground of DOOM"
			;

		function setup (){
			var random_id = "0000" + Math.floor(Math.random() * 10000);

            /* Connection declarations */
			app_name = app_name + ' ' + random_id.substring(random_id.length-4);

			sb = new Spacebrew.Client({reconnect:true});

			sb.name(app_name);
			sb.description("This triggers traps and such in our playground.");

            /* Dynamically creates publishers */
			$('.button').each(function() {
                var target = $(this).attr('id');
                sb.addPublish( target, "boolean", "false" );
			});

			sb.addSubscribe( "toggleBackground", "boolean" );

			sb.onBooleanMessage = onBooleanMessage;

			sb.connect();

            /* Listeners */
			$(".button").on("mousedown", function(e){
    			var target = $(this).attr('id');
    			sb.send(target, "boolean", "true");
			});

			$(".button").on("mouseup", function(e){
                var target = $(this).attr('id');
    			sb.send("buttonPressA", "boolean", "false");
			});
		}

        /* Reciever Call */
		function onBooleanMessage( name, value ){
			console.log("[onBooleanMessage] boolean message received ", value);

			if (name == "routeA"){

			}

			if (value) {
		        document.body.style.background = "rgb(100,255,100)";
			} else {
		        document.body.style.background = "rgb(220,220,220)";
			}
		}

	</script>
	</head>

	<body>
		<a class="button" id="sectionA1">1</a><br />
		<a class="button" id="sectionA2">2</a><br />
		<a class="button" id="sectionA3">3</a><br />
		<a class="button" id="sectionA4">4</a>
	</body>

</html>